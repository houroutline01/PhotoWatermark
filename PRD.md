# PhotoWatermark 项目产品需求文档 (PRD)

## 1. 项目概述

PhotoWatermark 是一个Python程序，用于自动在图片上添加基于拍摄时间的文本水印。该程序读取图片的EXIF信息，提取拍摄时间，并将该时间作为水印添加到图片上。

## 2. 功能需求

### 2.1 核心功能

1. **图片EXIF信息读取**
   - 用户输入图片文件路径
   - 程序读取该路径下所有图片文件的EXIF信息
   - 提取拍摄时间信息（年月日）

2. **水印自定义设置**
   - 字体大小设置
   - 字体颜色设置
   - 水印位置设置（左上角、居中、右下角等）

3. **水印绘制与保存**
   - 将文本水印绘制到原始图片上
   - 保存处理后的图片到新目录
   - 新目录命名为原目录名+"_watermark"，作为原目录的子目录

### 2.2 非功能性需求

1. **兼容性**
   - 支持常见图片格式（JPG, PNG, TIFF等）
   - 跨平台支持（Windows, macOS, Linux）

2. **性能要求**
   - 处理单张图片时间不超过2秒
   - 批量处理100张图片不超过2分钟

3. **错误处理**
   - 对无EXIF信息的图片进行适当处理
   - 对无效路径或文件进行错误提示

## 3. 用户界面设计

### 3.1 命令行界面

程序采用命令行交互方式：

```
请输入图片文件路径: [用户输入]
请选择水印位置: 
  1. 左上角
  2. 居中
  3. 右下角
请输入字体大小: [用户输入]
请输入字体颜色(R,G,B): [用户输入]
```

## 4. 技术实现方案

### 4.1 依赖库

- Pillow (PIL) - 图片处理
- ExifRead - EXIF信息读取

### 4.2 核心算法

1. 遍历指定目录下的所有图片文件
2. 读取每个图片的EXIF信息
3. 提取拍摄时间并格式化为年月日
4. 根据用户设置在图片上绘制文本水印
5. 保存处理后的图片到_watermark子目录

## 5. 项目结构

```
PhotoWatermark/
├── main.py              # 主程序入口
├── watermark_processor.py  # 水印处理核心模块
├── exif_reader.py       # EXIF信息读取模块
├── utils.py             # 工具函数模块
├── requirements.txt     # 依赖包列表
└── README.md            # 项目说明文档
```

## 6. 测试计划

### 6.1 单元测试

1. EXIF信息读取功能测试
2. 水印位置计算测试
3. 图片保存功能测试

### 6.2 集成测试

1. 完整流程测试（从读取到保存）
2. 异常情况处理测试

## 7. 部署说明

### 7.1 环境要求

- Python 3.7+
- 依赖包安装: `pip install -r requirements.txt`

### 7.2 运行方式

```bash
python main.py
```

## 8. 未来扩展

1. 支持更多水印样式（图片水印、旋转文字等）
2. 支持批量处理进度显示
3. 添加GUI界面